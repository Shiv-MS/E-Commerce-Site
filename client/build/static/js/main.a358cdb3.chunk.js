(this["webpackJsonppandora-client"]=this["webpackJsonppandora-client"]||[]).push([[0],{16:function(e,t,c){var n=c(11);e.exports={get_product:function(){return n("/api/product")},add_to_cart:function(e){return n.post("/api/users/cart",{item:e})},get_cart:function(){return n.get("/api/users/cart")},getByName:function(e){return n.post("/api/product/byname",{product_name:e})}}},39:function(e,t,c){},55:function(e,t,c){},75:function(e,t,c){},76:function(e,t,c){},85:function(e,t,c){},86:function(e,t,c){},87:function(e,t,c){},95:function(e,t,c){},97:function(e,t,c){"use strict";c.r(t);var n=c(1),a=c(21),s=c(17),r=c(20),i=c(6),o=c(43),l=c.n(o),d="GET_ERRORS",u="USER_LOADING",j="SET_CURRENT_USER",h="UPDATE_CART",b={isAuthenticated:!1,user:{},resetSuccess:!1,loading:!1,cart:[]},p={},m=function(e){var t,c=Object.keys(e),n=Object.values(e),a={};return c.forEach((function(e,c){t=Object(i.a)(Object(i.a)({},t),{},Object(r.a)({},e,n[c][1]))})),n.forEach((function(e,t){a=Object(i.a)(Object(i.a)({},a),{},Object(r.a)({},c[t],e[0]))})),[function(e,t){var n=!1,s={},r={};return c.forEach((function(c,i){var o=a[c],l=e[c];r=o(l,t),n=n||r!==l,s[c]=r})),n?s:e},t]}({auth:[function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return Object(i.a)(Object(i.a)({},e),{},{isAuthenticated:!l()(t.payload),user:t.payload});case u:return Object(i.a)(Object(i.a)({},e),{},{loading:!0});case h:return Object(i.a)(Object(i.a)({},e),{},{cart:t.payload});default:return e}},b],error:[function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d:return t.payload;default:return e}},p]}),O=c(0),x=Object(n.createContext)();function f(e){var t=Object(n.useReducer)(m[0],m[1]),c=Object(s.a)(t,2),a={state:c[0],dispatch:c[1]};return Object(O.jsx)(x.Provider,{value:a,children:e.children})}c(55);var g=c(9),v=c(3),_=c(23),N=c.n(_),y=c(11),w=c.n(y),C=function(e){e?w.a.defaults.headers.common.Authorization=e:delete w.a.defaults.headers.common.Authorization},k=function(e){return{type:j,payload:e}},S=function(e){return{type:d,payload:e.response.data}},R=function(e){return function(t){localStorage.removeItem("jwtToken"),C(!1),t(k({})),e.push("/login")}},T=(c(75),c(47)),E=(c(39),c(16)),A=c.n(E);var P=function(e){var t=e.product_name,c=e.image,a=e.product_price,s=e.rating,r=e._id,i=Object(n.useContext)(x),o=(i.state,i.dispatch);return Object(O.jsxs)("div",{className:"product",children:[Object(O.jsxs)("div",{className:"product_info",children:[Object(O.jsx)("p",{children:t}),Object(O.jsxs)("p",{className:"product_price",children:[Object(O.jsx)("small",{children:"$"}),Object(O.jsx)("strong",{children:a})]}),Object(O.jsx)("div",{className:"product_rating",children:Array(s).fill().map((function(e,t){return Object(O.jsx)("p",{children:"\u2b50"},t)}))})]}),Object(O.jsx)("img",{src:c,alt:""}),Object(O.jsx)("button",{onClick:function(){var e;e=r,A.a.add_to_cart(e).then((function(e){o({type:h,payload:e.data}),console.log(e)}))},children:"Add to Basket"})]})},L=c(111),B=(c(76),function(e){var t=Object(n.useContext)(x).state;console.log({state:t,props:e});var c=Object(n.useState)([]),a=Object(s.a)(c,2),r=a[0],i=a[1];return Object(n.useEffect)((function(){A.a.get_product().then((function(e){var t=Object(T.a)(e.data);console.log(t),i(t)})).catch((function(e){var t=e.message;console.log(t)}))}),[]),Object(O.jsx)("div",{className:"home",children:Object(O.jsxs)("div",{className:"home_container",children:[Object(O.jsx)("img",{className:"home_image",src:"https://i.pinimg.com/originals/4d/49/1d/4d491d7fefa56b86a888e0f1c218f652.jpg",alt:"Background image"}),Object(O.jsxs)(L.a,{container:!0,spacing:3,justify:"center",className:"home_row",children:[" ",(e.productQueryResults.length<=0?r:e.productQueryResults).map((function(e){var t=e.product_name,c=e.product_price,n=e._id,a=e.image;return Object(O.jsx)(L.a,{item:!0,xl:3,lg:3,sm:5,md:5,xs:12,children:Object(O.jsx)(P,{product_name:t,product_price:c,product_description:!0,_id:n,image:a})},n)}))]})]})})}),F=c(18),I=c.n(F),D=function(e){var t=Object(n.useContext)(x),c=t.state,a=t.dispatch,s=c.error,r=Object(n.useRef)(),i=Object(n.useRef)(),o=Object(n.useRef)(),l=Object(n.useRef)();Object(n.useEffect)((function(){c.auth.isAuthenticated&&e.history.push("/dashboard")}),[c,e]);return Object(O.jsx)("div",{className:"container",children:Object(O.jsx)("div",{className:"row",children:Object(O.jsxs)("div",{className:"col s8 offset-s2",children:[Object(O.jsxs)(g.b,{to:"/",className:"btn-flat waves-effect",children:[Object(O.jsx)("i",{className:"material-icons left",children:"keyboard_backspace"})," Back to home"]}),Object(O.jsxs)("div",{className:"col s12",style:{paddingLeft:"11.250px"},children:[Object(O.jsxs)("h4",{children:[Object(O.jsx)("b",{children:"Register"})," below"]}),Object(O.jsxs)("p",{className:"grey-text text-darken-1",children:["Already have an account? ",Object(O.jsx)(g.b,{to:"/login",children:"Login"})]})]}),Object(O.jsxs)("form",{noValidate:!0,onSubmit:function(t){t.preventDefault(),a(S({response:{data:{}}})),function(e,t){return function(c){c(S({response:{data:{}}})),w.a.post("/api/auth/register",e).then((function(e){return t.push("/login")})).catch((function(e){return c(S(e))}))}}({name:r.current.value,email:i.current.value,password:o.current.value,password2:l.current.value},e.history)(a)},children:[Object(O.jsxs)("div",{className:"input-field col s12",children:[Object(O.jsx)("input",{ref:r,error:s.name,name:"name",type:"text",className:I()("",{invalid:s.name})}),Object(O.jsx)("label",{htmlFor:"name",children:"Name"}),Object(O.jsx)("span",{className:"red-text",children:s.name})]}),Object(O.jsxs)("div",{className:"input-field col s12",children:[Object(O.jsx)("input",{ref:i,error:s.email,name:"email",type:"email",className:I()("",{invalid:s.email})}),Object(O.jsx)("label",{htmlFor:"email",children:"Email"}),Object(O.jsx)("span",{className:"red-text",children:s.email})]}),Object(O.jsxs)("div",{className:"input-field col s12",children:[Object(O.jsx)("input",{ref:o,error:s.password,name:"password",type:"password",className:I()("",{invalid:s.password})}),Object(O.jsx)("label",{htmlFor:"password",children:"Password"}),Object(O.jsx)("span",{className:"red-text",children:s.password})]}),Object(O.jsxs)("div",{className:"input-field col s12",children:[Object(O.jsx)("input",{ref:l,error:s.password2,name:"password2",type:"password",className:I()("",{invalid:s.password2})}),Object(O.jsx)("label",{htmlFor:"password2",children:"Confirm Password"}),Object(O.jsx)("span",{className:"red-text",children:s.password2})]}),Object(O.jsx)("div",{className:"col s12",style:{paddingLeft:"11.250px"},children:Object(O.jsx)("button",{className:"btn btn-large waves-effect waves-light hoverable blue accent-3",style:{width:"150px",borderRadius:"3px",letterSpacing:"1.5px",marginTop:"1rem"},type:"submit",children:"Sign Up"})})]})]})})})},U=(c(85),function(e){var t=Object(n.useContext)(x),c=t.state,a=t.dispatch,s=c.error,r=Object(n.useRef)(),i=Object(n.useRef)();Object(n.useEffect)((function(){c.auth.isAuthenticated&&e.history.push("/ShoppingCart")}),[c,e]);return Object(O.jsxs)("div",{className:"login",children:[Object(O.jsx)(g.b,{to:"/",children:Object(O.jsx)("img",{src:"https://trufit-assets.s3.amazonaws.com/003Project/images/images.png",alt:"",className:"login_logo"})}),Object(O.jsxs)("div",{className:"login_container",children:[Object(O.jsx)("h1",{children:"Sign-in"}),Object(O.jsxs)("form",{onSubmit:function(t){t.preventDefault(),a(S({response:{data:{}}})),function(e,t){return function(c){c(S({response:{data:{}}})),w.a.post("/api/auth/login",e).then((function(e){var n=e.data.token;localStorage.setItem("jwtToken",n),C(n);var a=N()(n);c(k(a)),t.push("/")})).catch((function(e){return c(S(e))}))}}({email:r.current.value,password:i.current.value},e.history)(a)},children:[Object(O.jsx)("h5",{children:"E-mail"}),Object(O.jsx)("input",{ref:r,error:s.incorrect,name:"email",type:"email"}),Object(O.jsx)("h5",{children:"Password"}),Object(O.jsx)("input",{ref:i,error:s.incorrect,name:"password",type:"password",className:I()("",{invalid:s.incorrect})}),Object(O.jsx)("button",{className:"login_signInButton",type:"submit",children:"Sign-in"})]}),Object(O.jsxs)("button",{className:"login_registerButton",type:"submit",children:["Don't have an account? ",Object(O.jsx)(g.b,{to:"/register",children:"Register"})]})]})]})}),Q=c(48),z=function(e){var t=e.component,c=Object(Q.a)(e,["component"]),a=Object(n.useContext)(x).state;return Object(O.jsx)(v.b,Object(i.a)(Object(i.a)({},c),{},{render:function(e){return!0===a.auth.isAuthenticated?Object(O.jsx)(t,Object(i.a)({},e)):Object(O.jsx)(v.a,{to:"/login"})}}))},G={getUser:function(){return w.a.get("/api/users/me")},get_cart:function(){return w.a.get("/api/users/cart")},delete_cart:function(e){return w.a.delete("/api/users/cart/".concat(e),{id:e})}},$=(c(86),c(87),c(44)),J=c.n($);var M=function(){var e=Object(n.useContext)(x),t=e.state,c=(e.dispatch,t.auth.cart);return Object(O.jsxs)("div",{className:"subtotal",children:[Object(O.jsx)(J.a,{renderText:function(e){return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("p",{children:["Subtotal (",c.length," items): ",Object(O.jsx)("strong",{children:e})]}),Object(O.jsxs)("small",{className:"subtotal__gift",children:[Object(O.jsx)("input",{type:"checkbox"})," This order contains a gift"]})]})},decimalScale:2,value:function(e){if(e.length>0){return e.map((function(e){return e.product_price})).reduce((function(e,t){return e+t}))}}(c),displayType:"text",thousandSeparator:!0,prefix:"$"}),Object(O.jsx)("button",{children:"Proceed to Checkout"})]})},H=function(e){var t=Object(n.useContext)(x),c=t.state,a=t.dispatch,s=(c.auth.user,c.auth.cart);Object(n.useEffect)((function(){c.auth.isAuthenticated||e.history.push("/login"),G.getUser().then((function(e){console.log({res:e})})).catch((function(e){return console.log({err:e})}))}),[c,e]);return Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{className:"checkout",children:[Object(O.jsxs)("div",{className:"checkout_left",children:[Object(O.jsx)("img",{className:"checkout_ad",src:"https://images-na.ssl-images-amazon.com/images/G/02/UK_CCMP/TM/OCC_Amazon1._CB423492668_.jpg",alt:"promotional banner"}),Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{className:"checkout_title",children:" Your Shopping Basket"}),Object(O.jsx)("ul",{children:s.length<1?Object(O.jsx)("p",{children:"Add items"}):s.map((function(e,t){return Object(O.jsxs)("div",{className:"product",children:[Object(O.jsxs)("div",{className:"product_info",children:[Object(O.jsx)("div",{children:e.product_name}),Object(O.jsxs)("p",{className:"product_price",children:[Object(O.jsx)("small",{children:"$"}),Object(O.jsx)("strong",{children:e.product_price})]})]}),Object(O.jsx)("img",{src:e.image,alt:""}),Object(O.jsx)("button",{id:e._id,onClick:function(){var t;t=e._id,G.delete_cart(t).then((function(e){a({type:h,payload:e.data}),console.log(e)}))},children:"Remove from cart"})]},e._id+t)}))})]})]}),Object(O.jsx)("div",{className:"checkout_right",children:Object(O.jsx)(M,{})})]}),Object(O.jsx)("button",{className:"btn btn-large waves-effect waves-light hoverable blue accent-3",style:{width:"150px",borderRadius:"3px",letterSpacing:"1.5px",marginTop:"1rem"},onClick:function(t){t.preventDefault(),R(e.history)(a)},children:"Logout"})]})},K=(c(95),c(45)),V=c.n(K),Y=c(46),q=c.n(Y);var W=function(e){var t=e.productQuery,c=e.setProductQuery,a=e.searchProduct,s=Object(n.useContext)(x),r=s.state,i=s.dispatch,o=r.auth.user;return Object(n.useEffect)((function(){A.a.get_cart().then((function(e){console.log({res:e}),i({type:h,payload:e.data})})).catch((function(e){return console.log({err:e})}))}),[o]),Object(O.jsxs)("div",{className:"header",children:[Object(O.jsx)(g.b,{to:"/",children:Object(O.jsx)("img",{src:"https://trufit-assets.s3.amazonaws.com/003Project/images/images.png",alt:"",className:"header_logo"})}),Object(O.jsxs)("div",{className:"header_search",children:[Object(O.jsx)("input",{type:"text",className:"header_searchInput",value:t,onChange:function(e){c(e.target.value)}}),Object(O.jsx)(V.a,{className:"header_searchIcon",onClick:function(){a(t)}})]}),Object(O.jsxs)("div",{className:"header_nav",children:[Object(O.jsx)(g.b,{to:"/login",children:Object(O.jsxs)("div",{className:"header_option",children:[Object(O.jsxs)("span",{className:"header_optionLineOne",children:["Hello ",o.name?"".concat(o.name):"Guest"]}),Object(O.jsx)("span",{className:"header_optionLineTwo",children:o.name?"Shopping Cart":"Sign In"})]})}),Object(O.jsxs)("div",{className:"header_option",children:[Object(O.jsx)("span",{className:"header_optionLineOne",children:"Return"}),Object(O.jsx)("span",{className:"header_optionLineTwo",children:"& Orders"})]}),Object(O.jsxs)("div",{className:"header_option",children:[Object(O.jsx)("span",{className:"header_optionLineOne",children:"Coming"}),Object(O.jsx)("span",{className:"header_optionLineTwo",children:"Soon..."})]}),Object(O.jsxs)("div",{className:"header_optionBasket",children:[Object(O.jsx)(q.a,{}),Object(O.jsx)("span",{className:"header_optionLineTwo header_basketCount",children:o.name?r.auth.cart.length:""})]})]})]})},X=function(){var e=Object(n.useContext)(x).dispatch,t=Object(n.useState)(""),c=Object(s.a)(t,2),a=c[0],r=c[1],i=Object(n.useState)([]),o=Object(s.a)(i,2),l=o[0],d=o[1];Object(n.useEffect)((function(){if(localStorage.jwtToken){var t=localStorage.jwtToken,c=N()(t),n=Date.now()/1e3;C(t),e(k(c)),c.exp<n&&(e(R()),window.location.href="./login")}}),[e]);return Object(O.jsx)(g.a,{children:Object(O.jsxs)("div",{className:"App",children:[Object(O.jsx)(W,{searchProduct:function(e){A.a.getByName(e).then((function(e){d(e.data)})).catch((function(e){console.log(e.message)}))},productQuery:a,setProductQuery:r}),Object(O.jsx)(v.b,{exact:!0,path:"/",children:Object(O.jsx)(B,{productQueryResults:l})}),Object(O.jsx)(v.b,{exact:!0,path:"/register",component:D}),Object(O.jsx)(v.b,{exact:!0,path:"/login",component:U}),Object(O.jsx)(v.d,{children:Object(O.jsx)(z,{exact:!0,path:"/shoppingCart",component:H})})]})})},Z=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,113)).then((function(t){var c=t.getCLS,n=t.getFID,a=t.getFCP,s=t.getLCP,r=t.getTTFB;c(e),n(e),a(e),s(e),r(e)}))};Object(a.render)(Object(O.jsx)(f,{children:Object(O.jsx)(X,{})}),document.getElementById("root")),Z()}},[[97,1,2]]]);
//# sourceMappingURL=main.a358cdb3.chunk.js.map